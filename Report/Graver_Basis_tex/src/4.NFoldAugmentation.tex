%\chapter{N-Fold augmentation algorithm} \label{framework}
\section{N-Fold augmentation algorithm}

% TODO: Generalized N-Fold?

A generalized N-Fold IP has constriction matrix A of the form ($A_i \in \mathbb{Z}^{rxt}, B_i \in \mathbb{Z}^{sxt}$):\\
\begin{equation*}
N^{(n)} = 
\begin{pmatrix}
A_1 & A_2 & \cdots & A_n \\
B_1 & 0   & \cdots & 0 \\
0   & B_2 & \cdots & 0 \\
\vdots    & \vdots & \ddots & \vdots  \\
0   & 0   & \cdots & B_n 
\end{pmatrix}
\end{equation*}

In this section we compute a bound for the $\ell_1$-norm of the elements in the Graver basis of the N-Fold matrix. For this purpose we present the \textit{Steinitz lemma}. We won't prove it but it can be seen in \cite{STEINITZ:1913}.

\begin{lemma}[\textbf{Steinitz Lemma}]
    Let $v_1,...,v_n$ be vectors with $||v_i|| \leq \Delta$ for $i = 1,...,n$. If $\sum_{i=1}^{n} v_i = 0$, then there is a reordering $\pi \in S_n$ such that for each $k \in \{1,...,n\}$ the partial sum $p_k := \sum_{i=1}^{k}v_{\pi(i)}$ satisfies $||p_k|| \leq n\Delta$.
\end{lemma}

It's possible (using Steinitz Lemma) to obtain a much tighter bound for the norm of the elements in the Graver basis than the ones mentioned before. This implies a restriction in the space of search for the improvement direction in the augmentation algorithm making it much faster.

\begin{lemma}[\textbf{N-Fold Graver basis bound}]
    For all $g \in Gr(N)$ $||g||_1 \leq L_B (2r\Delta L_B + 1)^r =: L_A$ where $L_B = (2s \Delta + 1)^s$
\end{lemma}
\vspace{-20pt}
\begin{proof}
Let $y$ be a Graver basis element of $\mathcal{N}$, in coherence with the block decomposition of $\mathcal{N}$ we split it in blocks $y^t = ((y^{(1)})^t, ... , (y^{(n)})^t)$. Since every $y^{(i)} \in ker(B^{(i)}$ we decompose it as the sum of Graver basis elements $y^{(i)} = y^{(i)}_1 +  ... + y^{(i)}_{N_i}$. We have:\\ %then:
\begin{equation*}
    0 = A_1y^{(1)} + ... + A_ny^{(n)} = A_1y^{(1)}_1 + ... + A_1y^{(1)}_{N_1} + ... + A_ny^{(n)}_1 + ... + A_ny^{(n)}_{N_n} =: v_1 + ... + v_N % \in \mathbb{Z}^r
\end{equation*}
% TODO: Explain the bound on ||v_i||_\infty!
For $N = \sum_{i=1}^n N_i$ and $||v_i||_\infty \leq \Delta L_B$ for all $i \in \{1, ..., N\}$. Note that $N \leq (2r\Delta L_B + 1)^r$.  At this point we can apply the Steinitz Lemma to reorder the $v_i$ to bound each partial sum by $r\Delta L_B$ in the $l_\infty$ norm.\\
\begin{equation*}
    ||y||_1 \leq L_B(2r\Delta L_B + 1)^r = (2s\Delta + 1)^s(2r\Delta (2s\Delta + 1)^s + 1)^r = L_A
\end{equation*}

%Where $v_i := A_iy^{(i)}_1 + ... + A_iy^{(i)}_{N_i}$. 
\end{proof}

Thank to this bound we can prove this. We won't prove it since we'll see in the next section another version of this algorithm in a more efficient schema. \cite{EISENBRAND:2018} (Lemmas 4 and 5).

% TODO: Bounded algorithm? Improve references inside document!
\begin{lemma}
The augmentation step of the bounded algorithm (Section 2.2) can be solved in time $nt(rs\Delta)^{\mathcal{O}(r^2s+rs^2)}$.
\end{lemma}

The only thing remaining then for determining the complexity is then bound the number of augmentation steps needed for the algorithm to finish. This is provided by the following lemma.

% TODO: Bounded algorithm? Improve references inside document!
\begin{lemma}
Consider the bounded algorithm for an N-Fold IP. Let $\Gamma := max_i(u_i - l_i)$. Given an initial feasible solution we can find an optimum solution applying the bounded algorithm, which executes the augmentation step at most $\mathcal{O}(nt log(\Gamma)log(nt\Gamma))$.  
\end{lemma}

% TODO: Explain we solve first the LP
This complexity depends on the lower and upper bounds since, at the end of the day, they are restrictions to the feasible region and therefore to the problem's complexity. In \cite{EISENBRAND:2018} they solve this issue by first solving the linear relaxation problem and then creating artificial $l$ and $u$ constraints which, thanks to a proximity bound they prove, keeps at least one optimum.

% TODO: Proof? At least explanation!
% TODO: LP??   Much to clarify here!
\begin{lemma}[\textbf{N-Fold augmentation algorithm complexity}]
    The N-Fold IP can be solved in time $(nt)^2 log^2(nt) \cdot \varphi (rs\Delta)^{O(r^2s + rs^2)} + LP$
\end{lemma}
%\hspace{15pt} [Eisenbrand, Hunkenschr√∂der, Klein 2018]
        